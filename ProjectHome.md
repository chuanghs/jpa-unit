## News ##
### If you're using JPAUnit comment on: [ISSUE-6](http://code.google.com/p/jpa-unit/issues/detail?id=6) ###


finally 0.9.4 is released with support for following **features**
  1. compound ids
  1. jpa2
  1. support for orm.xml
  1. embeddable types support
  1. runner implementation for JUnit
  1. injecting entitymanager

## About ##

This tool helps to set up automatic testing environment in which JPA code (JPQL, HQL, native SQL mixed with entities operations) is tested.

Reads xml file with entities and persists them using provided entity manager or hibernate session
  1. [How it works](howitworks.md)
  1. [Getting starter](getting_starter.md)
  1. [Zeroconf testing](zeroconf.md)
  1. [Changes](changes.md)
  1. [Roadmap](Roadmap.md)

## How to start ##

repository URL for maven users: **http://jpa-unit.googlecode.com/hg/repository**

```
   <repository>
      <id>jpa-unit-repo</id>
      <url>http://jpa-unit.googlecode.com/hg/repository</url>
   </repository>
...
   <dependency>
      <groupId>org.ormunit</groupId>
      <artifactId>ormunit-jpa</artifactId>
      <version>[0.1.0, 1.0.0]</version>
      <scope>test</scope>
   </dependency>
```

all you need to do is subclass `org.ormunit.junit.JPAUnitTestCase`

```

public class TestCaseSubclass extends JPAUnitTestCase {

  public TestCaseSubclass(){
    super("persistence-unit-name", "entities.xml");
  }

}
```

or

```
 new ORMUnitConfigurationReader(getClass())
                        .read(getClass().getResourceAsStream("your-test-entities.xml"), 
                              new JPAORMProvider(getEm()))
                        .execute();
```

or simply use junit runner
```
@RunWith(JPAUnitRunner.class)
@JPAUnitTestCase(unitName = "ormunit-jpa", ormUnitFileName = "JPAUnitRealEntitiesTest.xml")
public class JPAUnitRealEntitiesWithRunnerTest {

    @Em
    private EntityManager em;
    
    ....
}
```


and create orm unit compliant xml file
```
<ormunit> 
  <import class="org.jpaunit.node.SimplePOJO" alias="pojo" />  <!-- importing is not
 needed when using JPA with classes listed in persistence unit -->
  <import class="org.jpaunit.node.ComplexPOJO" alias="complexPOJO" /> 
  <import class="org.jpaunit.node.POJOWithGeneratedId" alias="GenIdPOJO" />

  <statement>create table tag (id integer primary key, value varchar(32))</statement>


  <complexPOJO id="1"  property1="some value of property1" /> <!--  -->
  <GenIdPOJO ormId="some id" property2="value" /> <!-- for entities with id generated by 
ORM provider, additional attribute can be used to wire it later -->

<!-- ../view_definitions.xml file contains some view creating ddl statements, 
these statements will be executed before following entities will be persisted and statemetns executed  -->
  <include src="../view_definitions.xml"/> 

  <pojo timestampValue="2010-12-18 22:29:11" pojoWithGeneratedIdPropert="ormref(some id)"> 

<!-- ref(1) means that in db there should 
already be an entity with id=1 of type of the otherEntity property 
or its definition should be in this file before pojo's definition,
ormref(some id) means that entity with ormId="some id" will be injected -->

    <otherEntity> ref(1) </otherEntity> 
    <complexType2>
      <stringValue>some string value</stringValue>
    </complexType2>
    <intValue>1</intValue>
    <booleanValue>true</booleanValue>
    <dateValue>2010-12-18</dateValue>
  </pojo>
</ormunit>
```